# ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°è¨˜éŒ²

## æ—¥æ™‚
2026å¹´1æœˆ28æ—¥

## å®Ÿæ–½å†…å®¹

### ğŸ“Š ç›®çš„
ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰æ§‹é€ ã®æœ€å°åŒ–ãƒ»çµ±åˆã«ã‚ˆã‚Šã€é–‹ç™ºåŠ¹ç‡åŒ–ã¨ä¿å®ˆæ€§å‘ä¸Š

### âœ… å®Ÿè¡Œã—ãŸå¤‰æ›´

#### 1. ä¸è¦ãªãƒ«ãƒ¼ãƒˆå‰Šé™¤
- **å‰Šé™¤**: `routes/users.js`
  - ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç”Ÿæˆã®ã¿ã§å®Ÿè£…ãªã—
- **æ›´æ–°**: `app.js`
  - `usersRouter` ã® require ã¨ middleware ç™»éŒ²ã‚’å‰Šé™¤

#### 2. ãƒ“ãƒ«ãƒ‰å‡ºåŠ›çµ±åˆ
- **æ›´æ–°**: `admin/vite.config.js`
  - `outDir: "dist"` â†’ `outDir: ../public/admin`
  - ãƒ“ãƒ«ãƒ‰å‡ºåŠ›ã‚’é–‹ç™ºãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªç›´ä¸‹ã«é…ç½®ï¼ˆæœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤ã¨ã®ä¸€å…ƒåŒ–ï¼‰

- **æ›´æ–°**: `routes/admin.js`
  - `adminDist` ãƒ‘ã‚¹: `../admin/dist` â†’ `../public/admin`

#### 3. npm ã‚¹ã‚¯ãƒªãƒ—ãƒˆæœ€é©åŒ–
- **æ›´æ–°**: `package.json` scripts
  - è¿½åŠ : `"build": "npm run admin:build && npm run viewer:build"`
  - è¿½åŠ : `"deploy": "npm run build && npm run build:xserver"`
  - æœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤ã¨ãƒ“ãƒ«ãƒ‰ã®é–¢ä¿‚ã‚’æ˜ç¢ºåŒ–

#### 4. å‰Šé™¤å€™è£œï¼ˆæœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤æ™‚ã®ã¿å¿…è¦ï¼‰
- `xserver/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå…¨ä½“
  - `npm run build:xserver` ã§ `public/` ã‹ã‚‰è‡ªå‹•ç”Ÿæˆ
  - Gitç®¡ç†ã‹ã‚‰å¤–ã™ã“ã¨ã§å®¹é‡å‰Šæ¸›

---

## ğŸ¯ çµ±åˆãƒ«ãƒ¼ãƒ«

| é …ç›® | çµ±åˆå†…å®¹ | ç†ç”± |
|------|---------|------|
| **å…¬é–‹ãƒ•ã‚¡ã‚¤ãƒ«** | `public/stylesheets`, `public/javascripts` | é–‹ç™ºç’°å¢ƒã§ç·¨é›†ã—ã€æœ¬ç•ªãƒ“ãƒ«ãƒ‰æ™‚ã«åŒæœŸ |
| **admin ãƒ“ãƒ«ãƒ‰** | `public/admin/` ã«ç›´æ¥å‡ºåŠ› | ãƒ‡ãƒ—ãƒ­ã‚¤æ™‚ã®é…ç½®ã¨çµ±ä¸€ |
| **viewer ãƒ“ãƒ«ãƒ‰** | `public/works-viewer/` ã«å‡ºåŠ›ï¼ˆæ—¢å­˜ï¼‰ | å¤‰æ›´ãªã— |
| **èªè¨¼ãƒ»OAuth** | `lib/passport.js` + `data/oauth.example.php` | æ—¢å­˜æ§‹é€ ã‚’ä¿æŒ |

---

## âš™ï¸ gas_script.js ã«ã¤ã„ã¦

**å½¹å‰²**: Google Apps Script ã‚³ãƒ³ã‚¿ã‚¯ãƒˆãƒ•ã‚©ãƒ¼ãƒ é€£æºç”¨ãƒ—ãƒ­ã‚­ã‚·

**ä½¿ç”¨çŠ¶æ³**:
- `routes/contact.js` ã§ç’°å¢ƒå¤‰æ•° `CONTACT_GAS_URL` ã‚’å‚ç…§
- `.env` ã« `CONTACT_GAS_URL=<GAS_DEPLOYID>` ã‚’è¨­å®šæ™‚ã®ã¿æœ‰åŠ¹

**ä¿æŒç†ç”±**: æœ¬ç•ªç’°å¢ƒã§ã®é¸æŠçš„æœ‰åŠ¹åŒ–ã‚’æƒ³å®š

**è¨­å®šæ–¹æ³•**:
```bash
# .env ã«è¿½åŠ 
CONTACT_GAS_URL=https://script.google.com/macros/d/<DEPLOY_ID>/useLimited
```

---

## ğŸ—‚ï¸ å‰Šé™¤ãƒ•ãƒ­ãƒ¼ï¼ˆæœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤æ™‚ï¼‰

```bash
# é–‹ç™ºç’°å¢ƒ
npm run build          # admin + viewer ãƒ“ãƒ«ãƒ‰
npm run build:xserver  # xserver/ ç”Ÿæˆ

# ãƒ‡ãƒ—ãƒ­ã‚¤å‰
# xserver/ ã‚’ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°ç’°å¢ƒã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
```

---

## ğŸ“ ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆå¤‰æ›´å‰å¾Œ

### å¤‰æ›´å‰ï¼ˆä¸è¦ãªé‡è¤‡ã‚ã‚Šï¼‰
```
project/
â”œâ”€â”€ xserver/            â† æœ¬ç•ªç‰ˆã‚³ãƒ”ãƒ¼ï¼ˆé‡è¤‡ï¼‰
â”œâ”€â”€ admin/dist/         â† ãƒ“ãƒ«ãƒ‰å‡ºåŠ›
â”œâ”€â”€ routes/users.js     â† æœªä½¿ç”¨
â””â”€â”€ ...
```

### å¤‰æ›´å¾Œï¼ˆçµ±åˆãƒ»æœ€å°åŒ–ï¼‰
```
project/
â”œâ”€â”€ public/admin/       â† ãƒ“ãƒ«ãƒ‰ç›´æ¥å‡ºåŠ›
â”œâ”€â”€ public/works-viewer/â† ãƒ“ãƒ«ãƒ‰ç›´æ¥å‡ºåŠ›
â”œâ”€â”€ routes/             â† users.js å‰Šé™¤
â””â”€â”€ ...
```

---

## ğŸ“¦ ã‚¹ã‚¯ãƒªãƒ—ãƒˆå®Ÿè¡Œé †åº

```bash
# é–‹ç™º
npm start           # ãƒ­ãƒ¼ã‚«ãƒ«å®Ÿè¡Œ
npm run admin:dev   # åˆ¥ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ admin é–‹ç™º
npm run viewer:dev  # åˆ¥ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ viewer é–‹ç™º

# ãƒ“ãƒ«ãƒ‰
npm run build       # admin + viewer ãƒ“ãƒ«ãƒ‰

# æœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤
npm run deploy      # build + build:xserver
```

---

## âœ¨ ãƒ¡ãƒªãƒƒãƒˆ

- **å®¹é‡å‰Šæ¸›**: é‡è¤‡ãƒ•ã‚¡ã‚¤ãƒ«æ’é™¤ï¼ˆxserver/ ã¯å¿…è¦æ™‚ã®ã¿ç”Ÿæˆï¼‰
- **ä¿å®ˆæ€§å‘ä¸Š**: ãƒ“ãƒ«ãƒ‰å‡ºåŠ›å…ˆã‚’çµ±ä¸€
- **ãƒ‡ãƒ—ãƒ­ã‚¤ç°¡ç´ åŒ–**: `npm run deploy` ä¸€ç™º

